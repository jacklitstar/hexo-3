# 1
$$
f(x)+s = f(x - \tau g_x)\\
m(\tau) = f(x) - \tau g_k^Tg_k + \frac{1}{2} \tau^2 g_k^T B g_k \\
\frac{\partial m}{\partial \tau } = -g_k^Tg_k + \tau g_k^T B g_k = 0\\
\tau = \frac{g_k^Tg_k}{g_k^TBg_k}\\
s= -\frac{g_k^Tg_k}{g_k^TBg_k}g_k
$$

# 2
Case 1: $g^TBg<0$
We have: 
$$s = -\frac{\Delta g}{\|g\|}$$
$$
\begin{aligned}
m(0) - m(s) &=\frac{\Delta g^Tg}{\|g\|} - \frac{1}{2} \Delta^2 \frac{g^TBg}{\|g\|^2}\\
&=\Delta\|g\| -  \frac{1}{2} \Delta^2 \frac{g^TBg}{\|g\|^2}\\
&\geq \Delta\|g\|\\
&\geq \frac 1 2 \|g\|\min\left\{\Delta,\frac{\|g\|}{\|B\|}\right\}
\end{aligned}
$$
Case 2: $g^TBg\geq 0$ . For this case, we have two small cases.  
First:
$$\frac{\|g\|^3}{\Delta g^TBg}\leq 1$$
We have:
$$\tau = \frac{\|g\|^3}{\Delta g^TBg}$$
$$s = -\frac{\|g\|^2 g}{g^TBg}$$
$$
\begin{aligned}
m(0) - m(s) &=-g^Ts - \frac 1 2 s^TBs\\
&=\frac 1 2\frac{\|g\|^4}{g^TBg}\\
&\geq \frac 1 2\frac{\|g\|^4}{\|B\| \|g\|^2}\\
&\geq \frac 1 2 \|g\|\min\left\{\Delta,\frac{\|g\|}{\|B\|}\right\}
\end{aligned}
$$
Second: 
$$\frac{\|g\|^3}{\Delta g^TBg}> 1$$
We have $\tau =1$ , silmilar to Case 1:
$$
\begin{aligned}
m(0) - m(s) &=\frac{\Delta g^Tg}{\|g\|} - \frac{1}{2} \Delta^2 \frac{g^TBg}{\|g\|^2}\\
&=\Delta\|g\| -  \frac{1}{2} \Delta^2 \frac{g^TBg}{\|g\|^2}\\
&\geq \Delta\|g\| -\frac1 2 \Delta^2 \frac{\|g\|^3}{\Delta\|g\|^2}\\
&= \frac 1 2 \Delta \|g\|\\
&\geq \frac 1 2 \|g\|\min\left\{\Delta,\frac{\|g\|}{\|B\|}\right\}
\end{aligned}
$$
# 3
## (1)
$p^TAq = 0$ , therefore they are conjugated.
## (2)
$\bold x = (x_1,x_2,x_3)^T, \bold y = (y_1,y_2,y_3)^T,x^TAy = 0$  
$x^TAy = (x_1+2x_2+x_3)y_1+(2x_1+6x_2)y_2+(x_1+4x_3)y_3 = 0$  
let $\bold x = (0,0,1)^T$, we can have: $\bold y = (-4,0,1)^T$

# 4
$x^TAy = 0$, if $x$ and $y$ are not linear independent, there exists $\lambda\in \R,\lambda\neq 0$, subject to: $x = \lambda y$ . Hence $x^TAy = \lambda x^TAx = 0$ . However $A$ is positive definite. Thus $x$ and $y$ are linear independent.

#  5
This is proved by python

# 6
## (1)
for 
$$(\alpha_k,\beta_k) =\arg \min_{\alpha,\beta}f(x_k +\alpha d_k +\beta s_{k-1})$$
take the partial derivative:
$$\frac{\partial f}{\partial \alpha} = g_{k+1}^Td_k = 0$$
$$\frac{\partial f}{\partial \beta} = g_{k+1}^Ts_{k-1} = 0$$
$$g_{k+1}^Ts_k = g_{k+1}^T(\alpha d_k +\beta s_{k-1})=\alpha g_{k+1}^Td_k+\beta g_{k+1}^Ts_{k-1} = 0$$

## (2)
when $f = \frac{1}{2}x^TGx+b^Tx$, $g(x) = Gx + b$, plug $g(x)$ into $\frac{\partial f}{\partial \alpha} = 0$ and $\frac{\partial f}{\partial \beta} = 0$ , we get:
$$
d_k^Tg_k + \alpha d_k^TGd_k + \beta d_k^T G s_{k-1} = 0\\
s_{k-1}^Tg_k + \alpha s_{k-1}^TGd_k + \beta s_{k-1}^TGs_{k-1} = 0
$$
change the form to $Ax=b$ :
$$
\begin{pmatrix}
d_k^Tg_k &d_k^T G s_{k-1}\\
s_{k-1}^TGd_k &s_{k-1}^TGs_{k-1}
\end{pmatrix}
\begin{pmatrix}
\alpha\\
\beta
\end{pmatrix}=
\begin{pmatrix}
-d_k^Tg_k\\
-s_{k-1}^Tg_k
\end{pmatrix}
$$
Using Cramer's Rule, $\Delta_k = \det (A)$ , we get $\alpha_k, \beta_k$ .  
Appying results from (1), we get:
$$
\begin{aligned}
f_{k+1}-f_k &=\frac{1}{2}(x_k +\alpha_k d_k +\beta s_{k-1})^TG(x_k +\alpha_k d_k +\beta s_{k-1}) - \frac{1}{2}x_k^TGx_k + b^T(\alpha_k d_k + \beta s_{k-1}) \\
&=\frac 1 2(x_k^TG+b^T)(\alpha_k d_k+\beta_k s_{k-1})+\frac 1 2(\alpha_k d_k+\beta_k s_{k-1} )^T(G(x_k+\alpha_k d_k+\beta_k s_{k-1})+b)\\
&=\frac 1 2 \alpha_k g_k^Td_k + \frac 1 2(\alpha_k d_k+\beta_k s_{k-1})^T(g_k + G(\alpha_k d_k+\beta_k s_{k-1}))\\
&=\frac 1 2 \alpha_k g_k^Td_k + \frac 1 2 s_k^Tg_{k+1}\\
&=\frac 1 2 \alpha_k g_k^Td_k
\end{aligned}
$$

## (3)
